(function(){"use strict";var e={129:function(e,a,s){var t=s(5130),o=s(6768);const r={id:"app"};function n(e,a,s,t,n,l){const i=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(i)])}var l={name:"App"},i=s(1241);const u=(0,i.A)(l,[["render",n]]);var c=u,d=s(1387),p=s(4232);const v={class:"home"},g={class:"auth-buttons"},m={class:"chat-container"},h={key:0,class:"loading-indicator"},f={class:"chat-history",ref:"chatHistoryDiv"},k=["innerHTML"],y=["innerHTML"],b={key:2},L=["onClick","aria-label"],w={key:0},C={key:1},E={class:"chat-input"},P=["disabled"],R=["disabled"];function A(e,a,s,r,n,l){return(0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("header",null,[a[8]||(a[8]=(0,o.Lk)("div",{class:"header-title-container"},[(0,o.Lk)("h1",{class:"header-title"},"リアルタイム夢解析チャットボット")],-1)),(0,o.Lk)("div",g,[r.isLoggedIn?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:a[0]||(a[0]=(...e)=>r.goToLogin&&r.goToLogin(...e))},"ログイン")),r.isLoggedIn?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:a[1]||(a[1]=(...e)=>r.goToRegister&&r.goToRegister(...e))},"会員登録")),r.isLoggedIn?((0,o.uX)(),(0,o.CE)("button",{key:2,onClick:a[2]||(a[2]=(...e)=>r.logout&&r.logout(...e))},"ログアウト")):(0,o.Q3)("",!0),r.isLoggedIn?((0,o.uX)(),(0,o.CE)("button",{key:3,onClick:a[3]||(a[3]=(...e)=>r.goToMyPage&&r.goToMyPage(...e))},"マイページ")):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",m,[r.isLoading?((0,o.uX)(),(0,o.CE)("div",h,a[9]||(a[9]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("span",null,"AI夢占い中・・・",-1)]))):(0,o.Q3)("",!0),(0,o.Lk)("div",f,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.chatHistory,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:(0,p.C4)(["chat-message",e.type])},["bot"===e.type?((0,o.uX)(),(0,o.CE)("div",{key:0,innerHTML:r.escapeHTML(e.text)},null,8,k)):"bot-restriction"===e.type?((0,o.uX)(),(0,o.CE)("div",{key:1,innerHTML:e.html},null,8,y)):((0,o.uX)(),(0,o.CE)("div",b,(0,p.v_)(e.text),1)),"bot"===e.type&&r.isLoggedIn?((0,o.uX)(),(0,o.CE)("button",{key:3,onClick:a=>r.toggleFavorite(e.id),class:(0,p.C4)(["favorite-button",e.isFavorite?"favorited":""]),"aria-label":e.isFavorite?"お気に入りを解除する":"お気に入りに追加する"},[e.isFavorite?((0,o.uX)(),(0,o.CE)("span",w,"❤️")):((0,o.uX)(),(0,o.CE)("span",C,"🤍"))],10,L)):(0,o.Q3)("",!0)],2)))),128))],512),(0,o.Lk)("div",E,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>r.message=e),onKeyup:a[5]||(a[5]=(0,t.jR)(((...e)=>r.sendMessage&&r.sendMessage(...e)),["enter"])),placeholder:"あなたの夢を教えてください...",disabled:r.isLoading},null,40,P),[[t.Jo,r.message]]),(0,o.Lk)("button",{onClick:a[6]||(a[6]=(...e)=>r.sendMessage&&r.sendMessage(...e)),disabled:r.isLoading},"送信",8,R),(0,o.Lk)("button",{onClick:a[7]||(a[7]=(...e)=>r.clearMessages&&r.clearMessages(...e)),class:"clear-button"},"メッセージクリア")])])])}s(4114);var M=s(4373),X=s(144),_=s(7411),K={name:"Home",setup(){const e=(0,X.KR)(""),a=(0,X.KR)([]),s=(0,X.KR)(!1),t=(0,X.KR)(!1),r=(0,X.KR)(null),n=(0,d.rd)(),l=(0,_.dj)(),i=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=async()=>{try{const e=await M.A.get("http://localhost:3000/api/checksession",{withCredentials:!0});s.value=e.data.loggedIn,s.value&&await c()}catch(e){console.error("ログイン状態確認エラー:",e)}},c=async()=>{try{const e=await M.A.get("http://localhost:3000/api/favorites",{withCredentials:!0});if("success"===e.data.status){const s=e.data.favorites.map((e=>e.message_id));a.value.forEach((e=>{"bot"===e.type&&(e.isFavorite=s.includes(e.id))}))}else l.error(e.data.message||"お気に入りの取得に失敗しました。")}catch(e){console.error("お気に入り取得エラー:",e),l.error("サーバーエラーが発生しました。")}},p=async e=>{if(!s.value)return void l.info("お気に入り機能を使用するにはログインが必要です。");const t=a.value.find((a=>a.id===e));if(t)try{if(t.isFavorite){const a=await M.A.delete(`http://localhost:3000/api/favorites/${e}`,{withCredentials:!0});"success"===a.data.status?(t.isFavorite=!1,l.success("お気に入りから解除しました。")):l.error(a.data.message||"お気に入り解除に失敗しました。")}else{const a=await M.A.post("http://localhost:3000/api/favorites",{messageId:e},{withCredentials:!0});"success"===a.data.status?(t.isFavorite=!0,l.success("お気に入りに追加しました。")):l.error(a.data.message||"お気に入り追加に失敗しました。")}}catch(o){console.error("お気に入り操作エラー:",o),l.error(o.response?.data?.message||"サーバーエラーが発生しました。")}},v=async()=>{if(!e.value.trim())return;const o=e.value.trim(),r=Date.now();a.value.push({id:r,text:o,type:"user",isFavorite:!1}),e.value="",t.value=!0;try{const e=await M.A.post("http://localhost:3000/api/interpret-dream",{dream:o},{headers:{"Content-Type":"application/json"},withCredentials:!0});if(e.data.success){const{interpretation:t,interactionId:o}=e.data;a.value.push({id:o,text:t,type:"bot",isFavorite:!1}),s.value&&await c()}else if("続きは会員登録が必要です。"===e.data.message){const e='続きは<a href="/register">会員登録</a>が必要です。';a.value.push({id:Date.now()+2,html:e,type:"bot-restriction",isFavorite:!1}),l.info("続きの会話には会員登録が必要です。会員登録ページに移動します。"),n.push("/register")}else a.value.push({id:Date.now()+3,text:e.data.message||"エラーが発生しました。もう一度お試しください。",type:"bot",isFavorite:!1})}catch(i){console.error("Error sending message:",i);const e=i.response&&i.response.data&&i.response.data.message?i.response.data.message:"エラーが発生しました。もう一度お試しください。";a.value.push({id:Date.now()+4,text:`エラーが発生しました: ${e}`,type:"bot",isFavorite:!1})}finally{t.value=!1,m()}},g=()=>{a.value=[]},m=()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight)},h=()=>n.push("/login"),f=()=>n.push("/register"),k=()=>n.push("/mypage"),y=async()=>{try{const e=await M.A.post("http://localhost:3000/api/logout",{},{withCredentials:!0});"success"===e.data.status?(s.value=!1,l.success("ログアウトしました。"),g(),n.push("/")):l.error("ログアウトに失敗しました。")}catch(e){console.error("Error logging out:",e),l.error("ログアウト中にエラーが発生しました。")}};return(0,o.sV)((()=>{u()})),{message:e,chatHistory:a,isLoggedIn:s,isLoading:t,sendMessage:v,clearMessages:g,goToLogin:h,goToRegister:f,goToMyPage:k,logout:y,escapeHTML:i,chatHistoryDiv:r,toggleFavorite:p}}};const D=(0,i.A)(K,[["render",A],["__scopeId","data-v-29f4e28c"]]);var F=D;const T={class:"login-container"},I={class:"form-group"},U={class:"form-group"},q={key:0,class:"error-message"},Q=["disabled"],j={key:1,class:"loading-spinner"};function O(e,a,s,r,n,l){const i=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",T,[a[7]||(a[7]=(0,o.Lk)("h2",null,"ログイン",-1)),(0,o.Lk)("form",{onSubmit:a[2]||(a[2]=(0,t.D$)(((...e)=>r.handleLogin&&r.handleLogin(...e)),["prevent"]))},[(0,o.Lk)("div",I,[a[3]||(a[3]=(0,o.Lk)("label",{for:"username"},"ユーザー名",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>r.username=e),required:"",placeholder:"ユーザー名を入力してください"},null,512),[[t.Jo,r.username]])]),(0,o.Lk)("div",U,[a[4]||(a[4]=(0,o.Lk)("label",{for:"password"},"パスワード",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":a[1]||(a[1]=e=>r.password=e),required:"",placeholder:"パスワードを入力してください"},null,512),[[t.Jo,r.password]])]),r.errorMessage?((0,o.uX)(),(0,o.CE)("div",q,(0,p.v_)(r.errorMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",disabled:r.isLoading}," ログイン ",8,Q),r.isLoading?((0,o.uX)(),(0,o.CE)("div",j," ログイン中... ")):(0,o.Q3)("",!0)],32),(0,o.Lk)("p",null,[a[6]||(a[6]=(0,o.eW)(" アカウントをお持ちでないですか？ ")),(0,o.bF)(i,{to:"/register"},{default:(0,o.k6)((()=>a[5]||(a[5]=[(0,o.eW)("会員登録はこちら")]))),_:1})])])}var V={name:"Login",setup(){const e=(0,X.KR)(""),a=(0,X.KR)(""),s=(0,X.KR)(""),t=(0,X.KR)(!1),o=(0,d.rd)(),r=async()=>{s.value="",t.value=!0;try{const t=await M.A.post("http://localhost:3000/api/login",{username:e.value,password:a.value},{headers:{"Content-Type":"application/json"},withCredentials:!0});"success"===t.data.status?(alert("ログインに成功しました。"),o.push("/")):s.value=t.data.message||"ログインに失敗しました。"}catch(r){console.error("ログインエラー:",r),s.value=r.response?.data?.message||"サーバーエラーが発生しました。"}finally{t.value=!1}};return{username:e,password:a,handleLogin:r,errorMessage:s,isLoading:t}}};const x=(0,i.A)(V,[["render",O],["__scopeId","data-v-132ceb76"]]);var H=x;const J={class:"register-container"},S={class:"form-group"},$={class:"form-group"},W={class:"form-group"},N={class:"form-group"},B={key:0,class:"error-message"},G=["disabled"],z={key:1,class:"loading-spinner"};function Y(e,a,s,r,n,l){const i=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",J,[a[11]||(a[11]=(0,o.Lk)("h2",null,"会員登録",-1)),(0,o.Lk)("form",{onSubmit:a[4]||(a[4]=(0,t.D$)(((...e)=>r.handleRegister&&r.handleRegister(...e)),["prevent"]))},[(0,o.Lk)("div",S,[a[5]||(a[5]=(0,o.Lk)("label",{for:"username"},"ユーザー名",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>r.username=e),required:"",placeholder:"ユーザー名を入力してください"},null,512),[[t.Jo,r.username]])]),(0,o.Lk)("div",$,[a[6]||(a[6]=(0,o.Lk)("label",{for:"email"},"メールアドレス",-1)),(0,o.bo)((0,o.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":a[1]||(a[1]=e=>r.email=e),required:"",placeholder:"メールアドレスを入力してください"},null,512),[[t.Jo,r.email]])]),(0,o.Lk)("div",W,[a[7]||(a[7]=(0,o.Lk)("label",{for:"password"},"パスワード",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":a[2]||(a[2]=e=>r.password=e),required:"",placeholder:"パスワードを入力してください"},null,512),[[t.Jo,r.password]])]),(0,o.Lk)("div",N,[a[8]||(a[8]=(0,o.Lk)("label",{for:"confirmPassword"},"パスワード確認",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":a[3]||(a[3]=e=>r.confirmPassword=e),required:"",placeholder:"パスワードを再度入力してください"},null,512),[[t.Jo,r.confirmPassword]])]),r.errorMessage?((0,o.uX)(),(0,o.CE)("div",B,(0,p.v_)(r.errorMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",disabled:r.isLoading}," 会員登録 ",8,G),r.isLoading?((0,o.uX)(),(0,o.CE)("div",z," 会員登録中... ")):(0,o.Q3)("",!0)],32),(0,o.Lk)("p",null,[a[10]||(a[10]=(0,o.eW)(" すでにアカウントをお持ちですか？ ")),(0,o.bF)(i,{to:"/login"},{default:(0,o.k6)((()=>a[9]||(a[9]=[(0,o.eW)("ログインはこちら")]))),_:1})])])}var Z={name:"Register",setup(){const e=(0,X.KR)(""),a=(0,X.KR)(""),s=(0,X.KR)(""),t=(0,X.KR)(""),o=(0,X.KR)(""),r=(0,X.KR)(!1),n=(0,d.rd)(),l=async()=>{if(o.value="",s.value===t.value){r.value=!0;try{const t=await M.A.post("http://localhost:3000/api/register",{username:e.value,email:a.value,password:s.value},{headers:{"Content-Type":"application/json"},withCredentials:!0});if("success"===t.data.status){const a=await M.A.post("http://localhost:3000/api/login",{username:e.value,password:s.value},{headers:{"Content-Type":"application/json"},withCredentials:!0});"success"===a.data.status?(alert("会員登録とログインに成功しました。ホームページに移動します。"),n.push("/")):o.value=a.data.message||"ログインに失敗しました。"}else o.value=t.data.message||"会員登録に失敗しました。"}catch(l){console.error("会員登録エラー:",l),o.value=l.response?.data?.message||"サーバーエラーが発生しました。"}finally{r.value=!1}}else o.value="パスワードが一致しません。"};return{username:e,email:a,password:s,confirmPassword:t,handleRegister:l,errorMessage:o,isLoading:r}}};const ee=(0,i.A)(Z,[["render",Y],["__scopeId","data-v-94ec8ca0"]]);var ae=ee;function se(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"Dashboard Component Placeholder")}var te={name:"Dashboard"};const oe=(0,i.A)(te,[["render",se],["__scopeId","data-v-482c2b0c"]]);var re=oe;const ne={class:"mypage-container"},le={key:0,class:"loading-spinner"},ie={key:1,class:"error-message"},ue={key:2},ce={class:"form-group"},de={class:"form-group"},pe={class:"form-group"},ve={class:"form-group"},ge={key:0,class:"error-message"},me=["disabled"],he={key:1,class:"loading-spinner"},fe={class:"navigation-links"},ke={class:"password-change-section"},ye={class:"account-deletion-section"},be={key:0,class:"confirmation-dialog"},Le={key:1,class:"error-message"},we={key:0,class:"success-message"};function Ce(e,a,s,r,n,l){const i=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",ne,[a[18]||(a[18]=(0,o.Lk)("h2",null,"マイページ",-1)),r.isLoading?((0,o.uX)(),(0,o.CE)("div",le," データを読み込み中... ")):(0,o.Q3)("",!0),r.errorMessage?((0,o.uX)(),(0,o.CE)("div",ie,(0,p.v_)(r.errorMessage),1)):(0,o.Q3)("",!0),r.isLoading||r.errorMessage?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",ue,[(0,o.Lk)("form",{onSubmit:a[4]||(a[4]=(0,t.D$)(((...e)=>r.handleUpdate&&r.handleUpdate(...e)),["prevent"]))},[(0,o.Lk)("div",ce,[a[8]||(a[8]=(0,o.Lk)("label",{for:"username"},"ユーザー名",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":a[0]||(a[0]=e=>r.username=e),placeholder:"ユーザー名を入力してください",required:""},null,512),[[t.Jo,r.username]])]),(0,o.Lk)("div",de,[a[9]||(a[9]=(0,o.Lk)("label",{for:"email"},"メールアドレス",-1)),(0,o.bo)((0,o.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":a[1]||(a[1]=e=>r.email=e),placeholder:"メールアドレスを入力してください",required:""},null,512),[[t.Jo,r.email]])]),(0,o.Lk)("div",pe,[a[10]||(a[10]=(0,o.Lk)("label",{for:"age"},"年齢",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",id:"age","onUpdate:modelValue":a[2]||(a[2]=e=>r.age=e),placeholder:"年齢を入力してください",min:"0"},null,512),[[t.Jo,r.age]])]),(0,o.Lk)("div",ve,[a[12]||(a[12]=(0,o.Lk)("label",{for:"gender"},"性別",-1)),(0,o.bo)((0,o.Lk)("select",{id:"gender","onUpdate:modelValue":a[3]||(a[3]=e=>r.gender=e),required:""},a[11]||(a[11]=[(0,o.Lk)("option",{disabled:"",value:""},"選択してください",-1),(0,o.Lk)("option",{value:"男性"},"男性",-1),(0,o.Lk)("option",{value:"女性"},"女性",-1),(0,o.Lk)("option",{value:"その他"},"その他",-1)]),512),[[t.u1,r.gender]])]),r.updateErrorMessage?((0,o.uX)(),(0,o.CE)("div",ge,(0,p.v_)(r.updateErrorMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:r.isUpdating}," プロフィール変更 ",8,me),r.isUpdating?((0,o.uX)(),(0,o.CE)("div",he," 更新中... ")):(0,o.Q3)("",!0)],32),(0,o.Lk)("div",fe,[(0,o.bF)(i,{to:"/home",class:"nav-link"},{default:(0,o.k6)((()=>a[13]||(a[13]=[(0,o.Lk)("button",{class:"btn btn-secondary"},"ホームへ戻る",-1)]))),_:1}),(0,o.bF)(i,{to:"/favorites",class:"nav-link"},{default:(0,o.k6)((()=>a[14]||(a[14]=[(0,o.Lk)("button",{class:"btn btn-secondary"},"お気に入り一覧",-1)]))),_:1})]),(0,o.Lk)("div",ke,[(0,o.bF)(i,{to:"/change-password",class:"nav-link"},{default:(0,o.k6)((()=>a[15]||(a[15]=[(0,o.Lk)("button",{class:"btn btn-secondary"},"パスワード変更",-1)]))),_:1})]),(0,o.Lk)("div",ye,[a[17]||(a[17]=(0,o.Lk)("h3",null,"アカウント削除",-1)),(0,o.Lk)("button",{onClick:a[5]||(a[5]=(...e)=>r.confirmDeleteAccount&&r.confirmDeleteAccount(...e)),class:"btn btn-danger"}," 退会 "),r.showDeleteConfirmation?((0,o.uX)(),(0,o.CE)("div",be,[a[16]||(a[16]=(0,o.Lk)("p",null,"本当にアカウントを削除しますか？この操作は取り消せません。",-1)),(0,o.Lk)("button",{onClick:a[6]||(a[6]=(...e)=>r.handleDeleteAccount&&r.handleDeleteAccount(...e)),class:"btn btn-danger confirm-button"},"はい、削除します"),(0,o.Lk)("button",{onClick:a[7]||(a[7]=(...e)=>r.cancelDeleteAccount&&r.cancelDeleteAccount(...e)),class:"btn btn-secondary cancel-button"},"キャンセル")])):(0,o.Q3)("",!0),r.deleteErrorMessage?((0,o.uX)(),(0,o.CE)("div",Le,(0,p.v_)(r.deleteErrorMessage),1)):(0,o.Q3)("",!0)]),r.successMessage?((0,o.uX)(),(0,o.CE)("div",we,(0,p.v_)(r.successMessage),1)):(0,o.Q3)("",!0)]))])}var Ee={name:"MyPage",setup(){const e=(0,d.rd)(),a=(0,X.KR)(""),s=(0,X.KR)(""),t=(0,X.KR)(""),r=(0,X.KR)(""),n=(0,X.KR)(!0),l=(0,X.KR)(!1),i=(0,X.KR)(""),u=(0,X.KR)(""),c=(0,X.KR)(""),p=(0,X.KR)(!1),v=(0,X.KR)(""),g=async()=>{try{const e=await M.A.get("http://localhost:3000/api/getUserData",{withCredentials:!0});if("success"===e.data.status){const o=e.data.user;a.value=o.name||"",s.value=o.email||"",t.value=null!==o.age&&void 0!==o.age?o.age:"",r.value=o.gender||""}else i.value=e.data.message||"ユーザーデータの取得に失敗しました。"}catch(e){console.error("ユーザーデータ取得エラー:",e),i.value=e.response?.data?.message||"サーバーエラーが発生しました。"}finally{n.value=!1}},m=async()=>{if(u.value="",c.value="",l.value=!0,""===a.value.trim())return u.value="ユーザー名は必須です。",void(l.value=!1);if(""===s.value.trim())return u.value="メールアドレスは必須です。",void(l.value=!1);const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!e.test(s.value.trim()))return u.value="有効なメールアドレスを入力してください。",void(l.value=!1);try{const e=await M.A.post("http://localhost:3000/api/updateUser",{username:a.value.trim(),email:s.value.trim(),age:t.value?parseInt(t.value):null,gender:r.value},{headers:{"Content-Type":"application/json"},withCredentials:!0});"success"===e.data.status?(c.value="プロフィールが更新されました。",await g()):u.value=e.data.message||"プロフィールの更新に失敗しました。"}catch(o){console.error("プロフィール更新エラー:",o),u.value=o.response?.data?.message||"サーバーエラーが発生しました。"}finally{l.value=!1}},h=()=>{p.value=!0},f=async()=>{v.value="";try{const a=await M.A.delete("http://localhost:3000/api/deleteAccount",{withCredentials:!0});"success"===a.data.status?(alert("アカウントが削除されました。ご利用ありがとうございました。"),e.push("/")):v.value=a.data.message||"アカウントの削除に失敗しました。"}catch(a){console.error("アカウント削除エラー:",a),v.value=a.response?.data?.message||"サーバーエラーが発生しました。"}finally{p.value=!1}},k=()=>{p.value=!1};return(0,o.sV)((()=>{g()})),{username:a,email:s,age:t,gender:r,isLoading:n,isUpdating:l,errorMessage:i,updateErrorMessage:u,successMessage:c,handleUpdate:m,showDeleteConfirmation:p,deleteErrorMessage:v,confirmDeleteAccount:h,handleDeleteAccount:f,cancelDeleteAccount:k}}};const Pe=(0,i.A)(Ee,[["render",Ce],["__scopeId","data-v-a51b50e0"]]);var Re=Pe;function Ae(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"Logout Component Placeholder")}var Me={name:"Logout"};const Xe=(0,i.A)(Me,[["render",Ae],["__scopeId","data-v-428bdaba"]]);var _e=Xe;const Ke={class:"password-change-container"},De={class:"form-group"},Fe={class:"form-group"},Te={class:"form-group"},Ie={key:0,class:"error-message"},Ue={key:1,class:"success-message"},qe=["disabled"],Qe={key:2,class:"loading-spinner"};function je(e,a,s,r,n,l){return(0,o.uX)(),(0,o.CE)("div",Ke,[a[7]||(a[7]=(0,o.Lk)("h2",null,"パスワード変更",-1)),(0,o.Lk)("form",{onSubmit:a[3]||(a[3]=(0,t.D$)(((...e)=>r.handleChangePassword&&r.handleChangePassword(...e)),["prevent"]))},[(0,o.Lk)("div",De,[a[4]||(a[4]=(0,o.Lk)("label",{for:"currentPassword"},"現在のパスワード",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"currentPassword","onUpdate:modelValue":a[0]||(a[0]=e=>r.currentPassword=e),placeholder:"現在のパスワードを入力してください",required:""},null,512),[[t.Jo,r.currentPassword]])]),(0,o.Lk)("div",Fe,[a[5]||(a[5]=(0,o.Lk)("label",{for:"newPassword"},"新しいパスワード",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"newPassword","onUpdate:modelValue":a[1]||(a[1]=e=>r.newPassword=e),placeholder:"新しいパスワードを入力してください",required:""},null,512),[[t.Jo,r.newPassword]])]),(0,o.Lk)("div",Te,[a[6]||(a[6]=(0,o.Lk)("label",{for:"confirmNewPassword"},"新しいパスワード確認",-1)),(0,o.bo)((0,o.Lk)("input",{type:"password",id:"confirmNewPassword","onUpdate:modelValue":a[2]||(a[2]=e=>r.confirmNewPassword=e),placeholder:"新しいパスワードを再度入力してください",required:""},null,512),[[t.Jo,r.confirmNewPassword]])]),r.passwordErrorMessage?((0,o.uX)(),(0,o.CE)("div",Ie,(0,p.v_)(r.passwordErrorMessage),1)):(0,o.Q3)("",!0),r.passwordSuccessMessage?((0,o.uX)(),(0,o.CE)("div",Ue,(0,p.v_)(r.passwordSuccessMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",disabled:r.isChangingPassword}," パスワード変更 ",8,qe),r.isChangingPassword?((0,o.uX)(),(0,o.CE)("div",Qe," 変更中... ")):(0,o.Q3)("",!0)],32)])}var Oe={name:"PasswordChange",setup(){const e=(0,d.rd)(),a=(0,X.KR)(""),s=(0,X.KR)(""),t=(0,X.KR)(""),o=(0,X.KR)(!1),r=(0,X.KR)(""),n=(0,X.KR)(""),l=async()=>{if(r.value="",n.value="",s.value===t.value){o.value=!0;try{const o=await M.A.post("http://localhost:3000/api/changePassword",{currentPassword:a.value,newPassword:s.value},{headers:{"Content-Type":"application/json"},withCredentials:!0});"success"===o.data.status?(n.value="パスワードが変更されました。",a.value="",s.value="",t.value="",e.push("/mypage")):r.value=o.data.message||"パスワードの変更に失敗しました。"}catch(l){console.error("パスワード変更エラー:",l),r.value=l.response?.data?.message||"サーバーエラーが発生しました。"}finally{o.value=!1}}else r.value="新しいパスワードが一致しません。"};return{currentPassword:a,newPassword:s,confirmNewPassword:t,isChangingPassword:o,passwordErrorMessage:r,passwordSuccessMessage:n,handleChangePassword:l}}};const Ve=(0,i.A)(Oe,[["render",je],["__scopeId","data-v-9a482416"]]);var xe=Ve;function He(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"DeleteAccount Component Placeholder")}var Je={name:"DeleteAccount"};const Se=(0,i.A)(Je,[["render",He]]);var $e=Se;function We(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"DeleteComplete Component Placeholder")}var Ne={name:"DeleteComplete"};const Be=(0,i.A)(Ne,[["render",We]]);var Ge=Be;function ze(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"PasswordResetRequest Component Placeholder")}var Ye={name:"PasswordResetRequest"};const Ze=(0,i.A)(Ye,[["render",ze]]);var ea=Ze;function aa(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",null,"PasswordReset Component Placeholder")}var sa={name:"PasswordReset"};const ta=(0,i.A)(sa,[["render",aa]]);var oa=ta;const ra={class:"favorites"},na={class:"favorites-container"},la={key:0,class:"loading-indicator"},ia={key:1,class:"no-favorites"},ua={key:2,class:"favorites-list"},ca=["onClick"];function da(e,a,s,t,r,n){return(0,o.uX)(),(0,o.CE)("div",ra,[(0,o.Lk)("header",null,[a[1]||(a[1]=(0,o.Lk)("h1",null,"お気に入り一覧",-1)),(0,o.Lk)("button",{onClick:a[0]||(a[0]=(...e)=>t.goBack&&t.goBack(...e))},"戻る")]),(0,o.Lk)("div",na,[t.isLoading?((0,o.uX)(),(0,o.CE)("div",la,a[2]||(a[2]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("span",null,"お気に入りデータを読み込み中...",-1)]))):(0,o.Q3)("",!0),t.isLoading||0!==t.favorites.length?((0,o.uX)(),(0,o.CE)("div",ua,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.favorites,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"favorite-card"},[(0,o.Lk)("h3",null,"対話 #"+(0,p.v_)(e.id),1),(0,o.Lk)("p",null,[a[3]||(a[3]=(0,o.Lk)("strong",null,"ユーザー:",-1)),(0,o.eW)(" "+(0,p.v_)(e.user_message),1)]),(0,o.Lk)("p",null,[a[4]||(a[4]=(0,o.Lk)("strong",null,"AI:",-1)),(0,o.eW)(" "+(0,p.v_)(e.ai_message),1)]),(0,o.Lk)("button",{class:(0,p.C4)(["btn","btn-danger"]),onClick:a=>t.removeFavorite(e.id),"aria-label":"お気に入りを解除する"}," お気に入り解除 ",8,ca)])))),128))])):((0,o.uX)(),(0,o.CE)("div",ia," お気に入りに登録されたインタラクションがありません。 "))])])}var pa={name:"Favorites",setup(){const e=(0,X.KR)([]),a=(0,X.KR)(!1),s=(0,d.rd)(),t=(0,_.dj)(),r=async()=>{a.value=!0;try{const a=await M.A.get("http://localhost:3000/api/favorites",{withCredentials:!0});"success"===a.data.status?e.value=a.data.favorites:t.error(a.data.message||"お気に入りの取得に失敗しました。")}catch(s){console.error("お気に入り取得エラー:",s),t.error(s.response?.data?.message||"サーバーエラーが発生しました。")}finally{a.value=!1}},n=async a=>{try{const s=await M.A.delete(`http://localhost:3000/api/favorites/${a}`,{withCredentials:!0});"success"===s.data.status?(e.value=e.value.filter((e=>e.id!==a)),t.success("お気に入りから解除しました。")):t.error(s.data.message||"お気に入り解除に失敗しました。")}catch(s){console.error("お気に入り解除エラー:",s),t.error(s.response?.data?.message||"サーバーエラーが発生しました。")}},l=()=>{s.push("/")};return(0,o.sV)((()=>{r()})),{favorites:e,isLoading:a,removeFavorite:n,goBack:l}}};const va=(0,i.A)(pa,[["render",da],["__scopeId","data-v-b96ff7ec"]]);var ga=va;const ma=M.A.create({baseURL:"http://localhost:3000/api",withCredentials:!0});var ha=ma;const fa=[{path:"/home",name:"Home",component:F},{path:"/login",name:"Login",component:H},{path:"/register",name:"Register",component:ae},{path:"/dashboard",name:"Dashboard",component:re},{path:"/mypage",name:"MyPage",component:Re,meta:{requiresAuth:!0}},{path:"/logout",name:"Logout",component:_e},{path:"/change-password",name:"PasswordChange",component:xe,meta:{requiresAuth:!0}},{path:"/delete-account",name:"DeleteAccount",component:$e,meta:{requiresAuth:!0}},{path:"/delete-complete",name:"DeleteComplete",component:Ge,meta:{requiresAuth:!0}},{path:"/password-reset-request",name:"PasswordResetRequest",component:ea},{path:"/password-reset/:resetKey",name:"PasswordReset",component:oa},{path:"/favorites",name:"Favorites",component:ga,meta:{requiresAuth:!0}},{path:"/",redirect:"/home"},{path:"/:pathMatch(.*)*",redirect:"/home"}],ka=(0,d.aE)({history:(0,d.LA)(),routes:fa});ka.beforeEach((async(e,a,s)=>{if(e.matched.some((e=>e.meta.requiresAuth)))try{const e=await ha.get("http://localhost:3000/api/checksession",{withCredentials:!0});e.data.loggedIn?s():s("/login")}catch(t){console.error("セッションチェックエラー:",t),s("/login")}else if("/login"===e.path||"/register"===e.path)try{const e=await ha.get("http://localhost:3000/api/checksession",{withCredentials:!0});e.data.loggedIn?s("/home"):s()}catch(t){s()}else s()}));var ya=ka;s(7917);const ba=(0,t.Ef)(c);ba.config.globalProperties.$axios=ha,ba.use(ya),ba.use(_.Ay,{position:_.II.TOP_RIGHT,timeout:5e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0}),ba.mount("#app")}},a={};function s(t){var o=a[t];if(void 0!==o)return o.exports;var r=a[t]={exports:{}};return e[t].call(r.exports,r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(a,t,o,r){if(!t){var n=1/0;for(c=0;c<e.length;c++){t=e[c][0],o=e[c][1],r=e[c][2];for(var l=!0,i=0;i<t.length;i++)(!1&r||n>=r)&&Object.keys(s.O).every((function(e){return s.O[e](t[i])}))?t.splice(i--,1):(l=!1,r<n&&(n=r));if(l){e.splice(c--,1);var u=o();void 0!==u&&(a=u)}}return a}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[t,o,r]}}(),function(){s.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(a,{a:a}),a}}(),function(){s.d=function(e,a){for(var t in a)s.o(a,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(a){return 0===e[a]};var a=function(a,t){var o,r,n=t[0],l=t[1],i=t[2],u=0;if(n.some((function(a){return 0!==e[a]}))){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(i)var c=i(s)}for(a&&a(t);u<n.length;u++)r=n[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(c)},t=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))}();var t=s.O(void 0,[504],(function(){return s(129)}));t=s.O(t)})();
//# sourceMappingURL=app.318444c0.js.map